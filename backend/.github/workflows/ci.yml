name: CI Pipeline  # 워크플로우 이름

on:  
  push:  # push될 때 실행
    branches:
      - main
  pull_request:  # PR 생성될 때 실행
    branches:
      - main

jobs:
  test:  # Job 이름
    runs-on: ubuntu-latest  # 실행 환경 (Ubuntu 최신 버전)
    
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3  # 저장소 코드 가져오기

      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'  # Node.js 20 버전 사용

      - name: Install Dependencies
        run: npm install  # 패키지 설치

      - name: Run Tests
        run: npm test  # Jest 테스트 실행

      - name: Upload Test Results
        if: always()  # 테스트가 실패해도 로그를 저장
        uses: actions/upload-artifact@v3
        with:
          name: test-results
          path: coverage  # 테스트 커버리지 저장
